<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>f_boxcox: A User-Friendly Box-Cox Transformation — f_boxcox • rfriend</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="f_boxcox: A User-Friendly Box-Cox Transformation — f_boxcox"><meta name="description" content="Performs a Box-Cox transformation on a dataset to stabilize variance and make the data more normally distributed. It also provides diagnostic plots and tests for normality. The transformation is based on code of MASS/R/boxcox.R. The function prints \(\lambda\) to the console and returns (output) the transformed data set."><meta property="og:description" content="Performs a Box-Cox transformation on a dataset to stabilize variance and make the data more normally distributed. It also provides diagnostic plots and tests for normality. The transformation is based on code of MASS/R/boxcox.R. The function prints \(\lambda\) to the console and returns (output) the transformed data set."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rfriend</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>f_boxcox: A User-Friendly Box-Cox Transformation</h1>

      <div class="d-none name"><code>f_boxcox.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs a Box-Cox transformation on a dataset to stabilize variance and make the data more normally distributed. It also provides diagnostic plots and tests for normality. The transformation is based on code of MASS/R/boxcox.R. The function prints \(\lambda\) to the console and returns (output) the transformed data set.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">f_boxcox</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  transform.data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">50</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"log-Likelihood"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  open_generated_files <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  close_generated_files <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"off"</span>,</span>
<span>  save_as <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_in_wdir <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector or a data frame with a single numeric column. The data to be transformed.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Numeric. Determines the accuracy of the estimate for lambda. Higher values increase computation time. Defaults to <code>3</code>.</p></dd>


<dt id="arg-range">range<a class="anchor" aria-label="anchor" href="#arg-range"></a></dt>
<dd><p>A numeric vector of length 2 defining the search interval for lambda. Defaults to <code>c(-2, 2)</code>.</p></dd>


<dt id="arg-plots">plots<a class="anchor" aria-label="anchor" href="#arg-plots"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, plots log-likelihood of the Box-Cox transformation, Histograms and Q-Q plots of the original and transformed data. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-transform-data">transform.data<a class="anchor" aria-label="anchor" href="#arg-transform-data"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, returns the transformed data. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>A small positive value used to determine when to switch from the power transformation to the log transformation for numerical stability. Default is <code>1/50</code>.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>Character string. Label for the x-axis in plots. Default is an expression object representing \(\lambda\).</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>Character string. Label for the y-axis in plots. Default is "log-Likelihood".</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric. Significance level for the Shapiro-Wilk test of normality. Default is <code>0.05</code>.</p></dd>


<dt id="arg-open-generated-files">open_generated_files<a class="anchor" aria-label="anchor" href="#arg-open-generated-files"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, opens the generated output files ('pdf', 'Word' or 'Excel') files depending on the output format. This to directly view the results after creation. Files are stored in tempdir(). Default is <code>TRUE</code>.</p></dd>


<dt id="arg-close-generated-files">close_generated_files<a class="anchor" aria-label="anchor" href="#arg-close-generated-files"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, closes open 'Word' files depending on the output format. This to be able to save the newly generated files. 'Pdf' files should also be closed before using the function and cannot be automatically closed.</p></dd>


<dt id="arg-output-type">output_type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>Character string specifying the output format: <code>"pdf"</code>, <code>"word"</code>, <code>"rmd"</code>, <code>"off"</code> (no file generated) or <code>"console"</code>. The option <code>"console"</code> forces output to be printed. Default is <code>"off"</code>.</p></dd>


<dt id="arg-save-as">save_as<a class="anchor" aria-label="anchor" href="#arg-save-as"></a></dt>
<dd><p>Character string specifying the output file path (without extension).
If a full path is provided, output is saved to that location.
If only a filename is given, the file is saved in <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.
If only a directory is specified (providing an existing directory with trailing slash),
the file is named "data_name_aov_output" in that directory. If an extension is provided the output format specified with option "output_type" will be overruled.
Defaults to <code>file.path(tempdir(), "data_name_summary.pdf")</code>.</p></dd>


<dt id="arg-save-in-wdir">save_in_wdir<a class="anchor" aria-label="anchor" href="#arg-save-in-wdir"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, saves the file in the working directory. Default is <code>FALSE</code>, this avoid unintended changes to the global environment. If <code>save_as</code> location is specified <code>save_in_wdir</code> is overwritten by <code>save_as</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to plotting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class 'f_boxcox' containing, among others, results from the boxcox transformation, lambda, the input data, transformed data, Shapiro-Wilk test on original and transformed data. Using the option "output_type", it can also generate output in the form of: R Markdown code, 'Word', or 'pdf' files. Includes print and plot methods for 'f_boxcox' objects.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses the following formula for transformation:
$$
 y(\lambda) =
   \begin{cases}
 \frac{y^\lambda - 1}{\lambda}, &amp; \lambda \neq 0 \\  \log(y), &amp; \lambda = 0
 \end{cases}
$$</p>
<p>where (\(y\)) is the data being transformed, and (\(\lambda\)) the transformation parameter, which is estimated from the data using maximum likelihood. The function computes the Box-Cox transformation for a range of \(\lambda\) values and identifies the \(\lambda\) that maximizes the log-likelihood function. The beauty of this transformation is that, it checks suitability of many of the common transformations in one run. Examples of most common transformations and their \(\lambda\) value is given below:
 <!-- % Adjusts row height (default is 1) --></p><table class="table table"><tr><td><strong>\(\lambda\)-Value</strong></td><td><strong>Transformation</strong></td></tr><tr><td><strong>———————–</strong></td><td><strong>———————–</strong></td></tr><tr><td>-2</td><td>\(\frac{1}{x^2}\)</td></tr><tr><td>-1</td><td>\(\frac{1}{x}  \)</td></tr><tr><td>-0.5</td><td>\(\frac{1}{\sqrt{x}}\)</td></tr><tr><td>0</td><td>\(log(x)\)</td></tr><tr><td>0.5</td><td>\(\sqrt{x}\)</td></tr><tr><td>1</td><td>\(x\)</td></tr><tr><td>2</td><td>\(x^2\)</td></tr><tr><td><strong>———————–</strong></td><td><strong>———————–</strong></td></tr></table><p>If the estimated transformation parameter closely aligns with one of the values listed in the previous table, it is generally advisable to select the table value rather than the precise estimated value. This approach simplifies interpretation and practical application.</p>
<p>The function provides diagnostic plots: a plot of log-likelihood against \(\lambda\) values and a Q-Q plot of the transformed data.It also performs a Shapiro-Wilk test for normality on the transformed data if the sample size is less than or equal to 5000.</p>
<p><strong>Note</strong>: For sample sizes greater than 5000, Shapiro-Wilk test results are not provided due to limitations in its applicability.</p>
<p>This function requires [Pandoc](https://github.com/jgm/pandoc/releases/tag) (version 1.12.3 or higher), a universal document converter.</p><ul><li><p><b>Windows:</b> Install Pandoc and ensure the installation folder <br> (e.g., "C:/Users/your_username/AppData/Local/Pandoc") is added to your system PATH.</p></li>
<li><p><b>macOS:</b> If using Homebrew, Pandoc is typically installed in "/usr/local/bin". Alternatively, download the .pkg installer and verify that the binary’s location is in your PATH.</p></li>
<li><p><b>Linux:</b> Install Pandoc through your distribution’s package manager (commonly installed in "/usr/bin" or "/usr/local/bin") or manually, and ensure the directory containing Pandoc is in your PATH.</p></li>
<li><p>If Pandoc is not found, this function may not work as intended.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>The core of calculating \(\lambda\) and the plotting was taken from: <br>
file MASS/R/boxcox.R copyright (C) 1994-2004 W. N. Venables and B. D. Ripley</p><ul><li><p><a href="https://r-coder.com/box-cox-transformation-r/" class="external-link">https://r-coder.com/box-cox-transformation-r/</a></p></li>
<li><p><a href="https://CRAN.R-project.org/package=MASS" class="external-link">https://CRAN.R-project.org/package=MASS</a></p></li>
</ul><p>Some code to present the result was taken and modified from file: <br>
rcompanion/R/transformTukey.r. (Developed by Salvatore Mangiafico)</p><ul><li><p><a href="https://rcompanion.org/handbook/I_12.html" class="external-link">https://rcompanion.org/handbook/I_12.html</a></p></li>
</ul><p>The explanation on BoxCox transformation provided here was provided by r-coder:</p><ul><li><p><a href="https://r-coder.com/box-cox-transformation-r/" class="external-link">https://r-coder.com/box-cox-transformation-r/</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://CRAN.R-project.org/package=MASS" class="external-link"><code>boxcox</code></a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>

<ul><li><p>Sander H. van Delden  <a href="mailto:plantmind@proton.me">plantmind@proton.me</a></p></li>
<li><p>Salvatore Mangiafico, <a href="mailto:mangiafico@njaes.rutgers.edu">mangiafico@njaes.rutgers.edu</a></p></li>
<li><p>W. N. Venables and B. D. Ripley</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create non-normal data in a data.frame or vector.</span></span></span>
<span class="r-in"><span><span class="va">df</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">100</span>, meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Store the transformation in object "bc".</span></span></span>
<span class="r-in"><span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="fu">f_boxcox</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print lambda and Shaprio.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Box-Cox</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> According to the Shapiro-Wilk test ( 2.923e-12  &lt;  0.05 ) original data is:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NOT normally distributed. Transformation will be applied...   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula used for transformation:   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> { (x^λ - 1) / λ } if λ != 0   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> { log(x)        } if λ == 0   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Box-Cox Transformation λ = -0.019   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> According to the Shapiro-Wilk test ( 0.9528  &gt;  0.05 ) data is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  normally distributed after transformation.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the QQ plots, Histograms and Lambda Log-Likelihood estimation.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_boxcox-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="f_boxcox-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or Directly use the transformed data from the f_boxcox object.</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">values_transformed</span> <span class="op">&lt;-</span> <span class="fu">f_boxcox</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">values</span><span class="op">)</span><span class="op">$</span><span class="va">transformed_data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">values_transformed</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] -0.23068155  1.53585356  0.07046118  0.12912907  1.68742230  0.45890387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7] -1.28038739 -0.69135420 -0.44755415  1.20995694  0.35858670  0.39924945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13]  0.11056642 -0.55878661  1.75691948  0.49550326 -2.00382113  0.69670354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19] -0.47492133 -1.07872969 -0.21842691 -1.03607026 -0.73396179 -0.62876541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] -1.71401123  0.83115436  0.15314986 -1.15053200  1.23899832  0.42474110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] -0.29590017  0.88755676  0.87084843  0.81520186  0.68415470  0.55101302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37] -0.06194814 -0.30685371 -0.38184952 -0.69931209 -0.20832850 -1.28073066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43]  2.12487209  1.19420531 -1.13517732 -0.40443078 -0.46873027  0.77421428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] -0.08343513  0.25270987 -0.02855450 -0.04288792  1.35096134 -0.22625592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  1.49483194 -1.57176501  0.58137889  0.12370863  0.21549918  0.37827357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] -0.50472822 -0.33426437 -1.02849548 -1.08277868  0.30265509  0.44630671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67]  0.05297755  0.91423398  2.01067104 -0.49332887 -2.36057439  0.99619010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] -0.71400047 -0.69252516  1.01564389 -0.28554481 -1.23498424  0.18099156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79] -0.13907479  0.00576387  0.38387365 -0.37196830  0.64044800 -0.22094904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85]  0.33073840  1.08548896  0.43338730 -0.32694287  1.13636063  0.98418561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91]  0.54554983  0.23819112 -0.63166654  1.34321498 -0.60369560  2.14250411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97]  1.51051115 -0.23622892 -1.03649491 -0.71522264</span>
<span class="r-in"><span></span></span>
<span class="r-plt img"><img src="f_boxcox-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sander H. van Delden.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

