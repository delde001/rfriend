<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform multiple aov() functions with optional data transformation, inspection and Post Hoc test. — f_aov • rfriend</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform multiple aov() functions with optional data transformation, inspection and Post Hoc test. — f_aov"><meta name="description" content="Performs an Analysis of Variance (ANOVA) on a given dataset with options for (Box-Cox)
transformations, normality tests, and post-hoc analysis. Several response parameters can be analysed in sequence and the generated output can be in various formats ('Word', 'pdf', 'Excel')."><meta property="og:description" content="Performs an Analysis of Variance (ANOVA) on a given dataset with options for (Box-Cox)
transformations, normality tests, and post-hoc analysis. Several response parameters can be analysed in sequence and the generated output can be in various formats ('Word', 'pdf', 'Excel')."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rfriend</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform multiple <code>aov()</code> functions with optional data transformation, inspection and Post Hoc test.</h1>

      <div class="d-none name"><code>f_aov.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs an Analysis of Variance (ANOVA) on a given dataset with options for (Box-Cox)
transformations, normality tests, and post-hoc analysis. Several response parameters can be analysed in sequence and the generated output can be in various formats ('Word', 'pdf', 'Excel').</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">f_aov</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm_plots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ANCOVA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  transformation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force_transformation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  adjust <span class="op">=</span> <span class="st">"sidak"</span>,</span>
<span>  intro_text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  close_generated_files <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  open_generated_files <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"off"</span>,</span>
<span>  save_as <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_in_wdir <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula specifying the model to be fitted. More response variables can be added using <code>-</code> or <code>+</code> (e.g., <code>response1 + response2 ~ predictor</code>) to do a sequential <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> for each response parameter.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables in the model.</p></dd>


<dt id="arg-norm-plots">norm_plots<a class="anchor" aria-label="anchor" href="#arg-norm-plots"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, plots are included in the output files. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-ancova">ANCOVA<a class="anchor" aria-label="anchor" href="#arg-ancova"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, prevents automatic conversion of predictors to factors, allowing for Analysis of Covariance (ANCOVA). Default is <code>FALSE</code>.</p></dd>


<dt id="arg-transformation">transformation<a class="anchor" aria-label="anchor" href="#arg-transformation"></a></dt>
<dd><p>Logical or character string. If <code>TRUE</code>, or if <code>"bestnormalize"</code>, applies <code>bestNormalize()</code> transformation if residuals are not normal. If <code>"boxcox"</code> applies a boxcox transformation. If <code>FALSE</code> no transformation will be applied. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-force-transformation">force_transformation<a class="anchor" aria-label="anchor" href="#arg-force-transformation"></a></dt>
<dd><p>Character string. A vector containing the names of response variables that should be transformed regardless of the normality test. Default is <code>NULL</code></p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric. Significance level for ANOVA, post hoc tests, and Shapiro-Wilk test. Default is <code>0.05</code>.</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Character string specifying the method used to adjust p-values
for multiple comparisons. Available methods include:</p><dl><dt>"tukey"</dt>
<dd><p>Tukey's Honest Significant Difference method, appropriate for
                all pairwise comparisons. Controls family-wise error rate.</p></dd>

  <dt>"sidak"</dt>
<dd><p>Šidák correction that controls the family-wise error rate.
                Less conservative than Bonferroni.</p></dd>

  <dt>"bonferroni"</dt>
<dd><p>Conservative adjustment that multiplies p-values by
                     the number of comparisons.</p></dd>

  <dt>"none"</dt>
<dd><p>No adjustment. Equivalent to Fisher's LSD method.</p></dd>

  <dt>"fdr"</dt>
<dd><p>False Discovery Rate adjustment, controls the expected proportion
              of false positives among significant results.</p></dd>


</dl><p>Default is <code>"sidak"</code>.</p></dd>


<dt id="arg-intro-text">intro_text<a class="anchor" aria-label="anchor" href="#arg-intro-text"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, includes a short explanation about ANOVA assumptions in the output file. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-close-generated-files">close_generated_files<a class="anchor" aria-label="anchor" href="#arg-close-generated-files"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, closes open 'Excel' or 'Word' files depending on the output format. This to be able to save the newly generated file by the <code>f_aov()</code> function. 'Pdf' files should also be closed before using the function and cannot be automatically closed. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-open-generated-files">open_generated_files<a class="anchor" aria-label="anchor" href="#arg-open-generated-files"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, Opens the generated output files ('pdf', 'Word' or 'Excel') files depending on the output format. This to directly view the results after creation. Files are stored in tempdir(). Default is <code>TRUE</code>.</p></dd>


<dt id="arg-output-type">output_type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>Character string specifying the output format: <code>"pdf"</code>, <code>"word"</code>, <code>"excel"</code>, <code>"rmd"</code>, <code>"console"</code> or <code>"off"</code> (no file generated). The option <code>"console"</code> forces output to be printed, the option <code>"rmd"</code> saves rmd code in the output object not in a file. Default is <code>"off"</code>.</p></dd>


<dt id="arg-save-as">save_as<a class="anchor" aria-label="anchor" href="#arg-save-as"></a></dt>
<dd><p>Character string specifying the output file path (without extension).
If a full path is provided, output is saved to that location.
If only a filename is given, the file is saved in <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>.
If only a directory is specified (providing an existing directory with trailing slash),
the file is named "dataname_aov_output" in that directory. If an extension is provided the output format specified with option "output_type" will be overruled.
Defaults to <code>file.path(tempdir(), "dataname_summary.pdf")</code>.</p></dd>


<dt id="arg-save-in-wdir">save_in_wdir<a class="anchor" aria-label="anchor" href="#arg-save-in-wdir"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, saves the file in the working directory. Default is <code>FALSE</code>, this avoid unintended changes to the global environment. If <code>save_as</code> location is specified <code>save_in_wdir</code> is overwritten by <code>save_as</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class 'f_aov' containing results from <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>, normality tests, transformations, and post hoc tests. Using the option "output_type", it can also generate output in the form of: R Markdown code, 'Word', 'pdf', or 'Excel' files. Includes print and plot methods for 'f_aov' objects.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps:</p><ul><li><p>Check if all specified variables are present in the data.</p></li>
<li><p>Ensure that the response variable is numeric.</p></li>
<li><p>Perform Analysis of Variance (ANOVA) using the specified formula and data.</p></li>
<li><p>If <code>shapiro = TRUE</code>, check for normality of residuals using the Shapiro-Wilk test.</p></li>
<li><p>If residuals are not normal and <code>transformation = TRUE</code> apply a data transformation.</p></li>
<li><p>If significant differences are found in ANOVA, proceed with post hoc tests using estimated marginal means from <code>emmeans()</code> and Sidak adjustment (or another option of <code>adjust =</code>.</p></li>
</ul><p>More response variables can be added using <code>-</code> or <code>+</code> (e.g., <code>response1 + response2 ~ predictor</code>) to do a sequential <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> for each response parameter captured in one output file.</p>
<p>Outputs can be generated in multiple formats ("pdf", "word", "excel" and "rmd") as specified by <code>output_type</code>. The function also closes any open 'Word' files to avoid conflicts when generating 'Word' documents. If <code>output_type = "rmd"</code> is used it is adviced to use it in a chunk with {r, echo=FALSE, results='asis'}</p>
<p>This function requires [Pandoc](https://github.com/jgm/pandoc/releases/tag) (version 1.12.3 or higher), a universal document converter.</p><ul><li><p><b>Windows:</b> Install Pandoc and ensure the installation folder.
<br> (e.g., "C:/Users/your_username/AppData/Local/Pandoc") is added to your system PATH.</p></li>
<li><p><b>macOS:</b> If using Homebrew, Pandoc is typically installed in "/usr/local/bin". Alternatively, download the .pkg installer and verify that the binary’s location is in your PATH.</p></li>
<li><p><b>Linux:</b> Install Pandoc through your distribution’s package manager (commonly installed in "/usr/bin" or "/usr/local/bin") or manually, and ensure the directory containing Pandoc is in your PATH.</p></li>
<li><p>If Pandoc is not found, this function may not work as intended.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sander H. van Delden  <a href="mailto:plantmind@proton.me">plantmind@proton.me</a> <br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Make a factor of Species.</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The left hand side contains two response variables,</span></span></span>
<span class="r-in"><span><span class="co"># so two aov's will be conducted, i.e. "Sepal.Width"</span></span></span>
<span class="r-in"><span><span class="co"># and "Sepal.Length" in response to the explanatory variable: "Species".</span></span></span>
<span class="r-in"><span><span class="va">f_aov_out</span> <span class="op">&lt;-</span> <span class="fu">f_aov</span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">iris</span>,</span></span>
<span class="r-in"><span>                   <span class="co"># Save output in MS Word file (Default is console)</span></span></span>
<span class="r-in"><span>                   output_type <span class="op">=</span> <span class="st">"word"</span>,</span></span>
<span class="r-in"><span>                   <span class="co"># Do boxcox transformation for non-normal residual (Default is bestnormalize)</span></span></span>
<span class="r-in"><span>                   transformation <span class="op">=</span> <span class="st">"boxcox"</span>,</span></span>
<span class="r-in"><span>                   <span class="co"># Do not automatically open the file.</span></span></span>
<span class="r-in"><span>                   open_generated_files <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>                   <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving output in: /tmp/RtmpDUIw9V/iris_aov_output.docx</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print output to the console.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f_aov_out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ==========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ANOVA of repsone variable:  Sepal.Width </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aov call:  Sepal.Width ~ Species </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species       2  11.35   5.672   49.16 &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals   147  16.96   0.115                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post-Hoc Analysis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Species    emmean        SE  df lower.CL upper.CL Letter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  versicolor  2.770 0.0480391 147 2.653974 2.886026  a    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  virginica   2.974 0.0480391 147 2.857974 3.090026   b   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  setosa      3.428 0.0480391 147 3.311974 3.544026    c  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conf-level adjustment: sidak method for 3 estimates </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: sidak method for 3 tests </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> significance level used: alpha = 0.05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: If two or more means share the same grouping symbol,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       then we cannot show them to be different.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       But we also did not show them to be the same. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ==========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ANOVA of Box-Cox TRANSFORMED repsone variable: Sepal.Length </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  aov call:  Sepal.Length ~ Species </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TRANSFORMED Summary Table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species       2  63.21  31.606   119.3 &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals   147  38.96   0.265                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TRANSFORMED Post-Hoc Analysis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Species      emmean          SE  df lower.CL upper.CL Letter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  setosa     1.434181 0.009363675 147 1.411565 1.456796  a    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  versicolor 1.566352 0.009363675 147 1.543737 1.588968   b   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  virginica  1.645523 0.009363675 147 1.622908 1.668139    c  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conf-level adjustment: sidak method for 3 estimates </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: sidak method for 3 tests </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> significance level used: alpha = 0.05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: If two or more means share the same grouping symbol,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       then we cannot show them to be different.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       But we also did not show them to be the same. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot residual plots.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f_aov_out</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="f_aov-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="f_aov-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="f_aov-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="f_aov-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#To print rmd output set chunck option to results = 'asis' and use cat().</span></span></span>
<span class="r-in"><span><span class="va">f_aov_rmd_out</span> <span class="op">&lt;-</span> <span class="fu">f_aov</span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span>, output_type <span class="op">=</span> <span class="st">"rmd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">f_aov_rmd_out</span><span class="op">$</span><span class="va">rmd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Assumptions of ANOVA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking the assumptions of ANOVA (Analysis of Variance) are critical for ensuring the validity of its results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## 1. Independence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Observations must be independent both within and between groups.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - This means that the value of one observation should not influence another.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Independence violations cannot be corrected statistically and invalidate the analysis, making proper experimental design essential.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## 2. Normality</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - The residuals (errors) of the model are assumed to be normally distributed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - This assumption applies to the residuals, not necessarily the raw data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - ANOVA is robust to minor deviations from normality, especially with large and balanced sample sizes. For small or unbalanced samples, violations can lead to **unreliable results**, requiring a data transformation or alternative tests (Welch's ANOVA, Kruskal-Wallis Test).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Normality of the residuals can be tested using a Shapiro Wilcoxon or Anderson-Darling Test. It can also be graphically assessed using a Box Plot, Q-Q plot or Histogram (see figure below).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## 3. Homogeneity of Variances (Homoscedasticity)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - The variances within each group should be approximately equal.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Equal  variances ensure that the F-test statistic is reliable.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Homogeneity of variances assumption in ANOVA should be tested on the residuals, not directly on the raw data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Levene's test or Bartlett's test can be applied to check for homogeneity of variances.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - If violated, a data transformation or alternative tests (Welch's ANOVA, Kruskal-Wallis Test) are required.  It can also be graphically assessed by plotting residuals vs. fitted values and checking for patterns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## 4. Additivity (No Unaccounted Systematic Effects)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - For models without interaction terms, it is assumed that the effects of different factors are additive. That is, the combined effect of factors can be expressed as the sum of their individual effects.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - However, if interaction terms are included in the model, this assumption does not apply because ANOVA explicitly accounts for interactions.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Analysis of:  Sepal.Width   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Normality and homoscedasticity of residuals of:  Sepal.Width   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levene's test for homogeneity of residuals: F-Statisic = 0.5902 p-value = 0.5555    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  According to 'Levene's Test' (0.5555 &gt; 0.05) residuals **have equal variance** (homoscedasticity).  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &amp;nbsp;  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shapiro-Wilk Test for Normality of residuals: W = 0.9895 p-value = 0.323    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  According to 'Shapiro-Wilk Test' (0.323 &gt; 0.05) residuals **ARE normally distributed**.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &amp;nbsp;  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anderson-Darling normality test : A = 0.495  p = 0.2116    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Check the plots in the figure below to assess normality.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ![](/tmp/RtmpDUIw9V/file20964b27ed1e.png)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &amp;nbsp;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## ANOVA Summary of  Sepal.Width   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &amp;nbsp;          Df    Sum Sq   Mean Sq   F value   Pr(&gt;F)         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------- ----- -------- --------- --------- ---------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **Species**     2     11.34    5.6725    49.16     **4.492e-17**  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **Residuals**   147   16.96    0.1154    NA        NA             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> aov call:  Sepal.Width ~ Species&amp;nbsp;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &amp;nbsp;   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Post Hoc Test Results of  Sepal.Width   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species      emmean   SE        df    lower.CL   upper.CL   Letter  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------ -------- --------- ----- ---------- ---------- --------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> versicolor   2.770    0.04804   147   2.654      2.886      a       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> virginica    2.974    0.04804   147   2.858      3.090      b       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setosa       3.428    0.04804   147   3.312      3.544      c       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conf-level adjustment: sidak method for 3 estimates  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: sidak method for 3 tests  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> significance level used: alpha = 0.05  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: If two or more means share the same grouping symbol,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       then we cannot show them to be different.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       But we also did not show them to be the same.</span>
<span class="r-in"><span></span></span>
<span class="r-plt img"><img src="f_aov-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sander H. van Delden.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

